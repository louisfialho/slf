<!-- BEGINNING OF NAVBAR -->
<div class="navbar" id="navshow">
  <div>
    <% if @parent_space %>
      <%= link_to image_tag("left_arrow.png", width: 37).html_safe, space_path(@parent_space) %>
    <% else %>
      <%= link_to image_tag("left_arrow.png", width: 37).html_safe, shelf_path(@shelf_mother) %>
    <% end %>
  </div>

  <div>
    <a target="_blank" rel="noopener noreferrer" href="<%= @item.url %>">
      <% if @item.medium == "book" %>
        <%= image_tag "book.png", width: 37 %>
      <% elsif @item.medium == "podcast" %>
        <%= image_tag "podcast.png", width: 37 %>
      <% elsif @item.medium == "video" %>
        <%= image_tag "video.png", width: 37 %>
      <% elsif @item.medium == "web" %>
        <%= image_tag "web.png", width: 37 %>
      <% elsif @item.medium == "other" %>
        <%= image_tag "web.png", width: 37 %>
      <% end %>
    </a>
  </div>

  <% if user_signed_in? %>
    <a><%= image_tag "options.png", alt: "Options", width: 37, class: 'item-options', id: 'options-btn' %></a>
  <% else %>
    <%= link_to('Login', new_user_session_path, class: 'login expand') %>
  <% end %>
</div>
<!-- END OF NAVBAR -->

<div class="main-container">
  <a target="_blank" rel="noopener noreferrer" href="<%= @item.url %>">
    <h1 class="item-title">
      <%= @item.name %>
    </h1>
  </a>

  <div class='notes'>
    <% if @current_user == @shelf_mother.user %>
      <% if @shelf %>
        <%= simple_form_for (@item) do |f| %>
          <%= f.input :notes, as: :text, placeholder: 'Click to add notes...', label: false, html: {autocomplete: 'disabled'}, :input_html => {:style => 'width: 100%', rows: '14', class: "txt-area", id: "txt-area" } %>
          <%= f.hidden_field :shelf_id, :value => @shelf.id %>
          <div class='buttonHolder'>
            <%= f.submit "Save notes", class: "add-btn", id: "save-notes", style: "display:none;" %>
          </div>
         <% end %>

      <% elsif @space %>
        <%= simple_form_for (@item) do |f| %>
          <%= f.input :notes, as: :text, placeholder: 'Click to add notes...', label: false, html: {autocomplete: 'disabled'}, :input_html => {:style => 'width: 100%', rows: '14', class: "txt-area", id: "txt-area" } %>
          <%= f.hidden_field :space_id, :value => @space.id %>
          <div class='buttonHolder'>
            <%= f.submit "Save notes", class: "add-btn", id: "save-notes", style: "display:none;" %>
          </div>
        <% end %>
      <% end %>
    <% else %>
      <% if @item.notes.nil? %>
        <p class="txt-area" id="txt-area"> <i> <%= @shelf_mother.user.first_name %> did not add any note to this object 📝 </i></p>
      <% else %>
        <p style="white-space: pre-line" class="txt-area" id="txt-area">
          <%= @item.notes %>
        </p>
      <% end %>
    <% end %>
  </div>
</div>

<!-- OPTIONS -->
  <% if user_signed_in? %>
    <div class="options-ctn item-options" id="options" style="display:none;">
      <% if @current_user == @shelf_mother.user %>
        <div class="option-ctn">
          <a>👉</a>
          <a class="option-label" id="move-to">Move</a>
        </div>
        <div class="option-ctn">
          <a>🗑</a>
          <% if @shelf %>
            <%= link_to "Delete", item_path(@item, shelf_id: @shelf.id), method: :delete, class: "option-label" %>
          <% elsif @space %>
            <%= link_to "Delete", item_path(@item, space_id: @space.id), method: :delete, class: "option-label" %>
          <% end %>
        </div>
      <% else %>
        <div class="option-ctn">
          <a>🏠</a>
          <%= link_to 'Back to my shelf', shelf_path(@current_user.shelves.first), class: "option-label" %>
        </div>
      <% end %>
    </div>
  <% end %>
<!-- END OF OPTIONS -->

<!-- MOVE TO LIST -->
<% if user_signed_in? %>
  <div class="options-ctn" id="move-to-list" style="display:none;" data-type="item" data-item-id="<%= @item.id %>" data-shelf-id="<%= @shelf.id %>">
    <div id="top-line">
      <%= image_tag("left_arrow.png", width: 23, height: 25, style: 'display:none;', id: 'left-arrow-img').html_safe %>
      <p class="option" id="top-element">Shelf</p>
    </div>
    <hr/>
    <ul id="children-spaces">
    <% move_to_space_list.each do |space| %>
      <li>
        <a class="option" id="child-space-<%= space.id %>" data-space-id="<%= space.id %>">🗄 <%= truncate(space.name, length: 25) %></a>
      </li>
    <% end %>
    </ul>
      <div id="button-new-space-parent">
        <%= image_tag("grey_plus.png", width: 18, height: 18, id: 'grey-plus-img').html_safe %>
        <div id="new-space-txt">New</div>
      </div>
    <%= button_to "👉 Move to shelf", { controller: "items", action: "move_to_shelf", item_id: @item.id }, id: 'move-to-button' %>
  </div>
<% end %>
<!-- END OF MOVE TO LIST -->


<!-- ADD SPACE NAME BOX -->
    <div class="options-ctn options-ctn-shelf-space" id="add-space" style="display:none;">
      <p class="option prompt" id="add-space-prompt" > What is the name of this new space? 🗄 </p>
      <%= simple_form_for @child, html: { autocomplete: 'off' } do |f| %>
        <%= f.text_field :name, class: 'txt-inpt txt-inpt-box' %> <!-- autofocus: true, onblur: 'this.focus()' --> <!-- onpaste: 'setTimeout(function(){ form.submit(); }, 0.1); -->
        <%= f.hidden_field :shelf_id, :value => @shelf_mother.id %>
        <%= f.hidden_field :item_id, :value => @item.id %>
        <%= f.submit "Add space", style: "display: none;" %>
      <% end %>
    </div>
<!-- END OF ADD SPACE NAME BOX -->














